<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Penilaian Tahfidz</title>
  <style>
    body { background: #f4f7fa; font-family: Arial, sans-serif; }
    .container { background: #fff; max-width: 400px; margin: 30px auto; border-radius: 16px; box-shadow: 0 4px 16px rgba(0,0,0,0.08); padding: 32px 24px; }
    h2 { text-align: center; margin-bottom: 24px; font-size: 1.5em; font-weight: bold; }
    label { display: block; margin-bottom: 6px; font-size: 1em; }
    select, textarea { width: 100%; padding: 8px 10px; margin-bottom: 16px; border: 1px solid #ccc; border-radius: 6px; font-size: 1em; box-sizing: border-box; }
    textarea { resize: vertical; min-height: 60px; max-height: 120px; }
    .btn-submit { width: 100%; padding: 10px 0; background: #22c55e; color: #fff; border: none; border-radius: 6px; font-size: 1em; font-weight: bold; cursor: pointer; transition: background 0.2s; }
    .btn-submit:hover { background: #16a34a; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Penilaian Tahfidz</h2>
    <form>
      <label for="penguji">Nama Penguji</label>
      <select id="penguji" name="penguji"><option value="">Memuat...</option></select>

      <label for="kelas">Kelas</label>
      <select id="kelas" name="kelas"><option value="">Memuat...</option></select>

      <label for="siswa">Nama Siswa</label>
      <select id="siswa" name="siswa"><option value="">Pilih kelas dulu</option></select>

      <label for="surat">Surat</label>
      <select id="surat" name="surat"><option value="">Memuat...</option></select>

      <label for="keterangan">Keterangan</label>
      <select id="keterangan" name="keterangan"><option value="">Memuat...</option></select>

      <label for="catatan">Catatan:</label>
      <textarea id="catatan" name="catatan" placeholder="Tulis catatan di sini..."></textarea>

      <button type="submit" class="btn-submit">Kirim</button>
    </form>
  </div>

  <script>
    const baseUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR2sH-s2vgdr92fkUTW3szhKHQQPZhuuUXd62S-kk95uVXJ57kVw8LCnkDBMvzaneEP3t5A4-ePE70q/gviz/tq?tqx=out:json&sheet=';

    const sheetNames = {
      penguji: 'Nama',
      kelas: 'Kelas',
      surat: 'Surat',
      keterangan: 'Keterangan',
      siswa: {
        'X': 'Siswa X',
        'XI': 'Siswa XI',
        'XII': 'Siswa XII'
      }
    };

    async function fetchSheet(sheetName) {
      const url = baseUrl + encodeURIComponent(sheetName);
      const res = await fetch(url);
      const text = await res.text();
      const json = JSON.parse(text.substring(47, text.length - 2));
      const rows = json.table.rows;
      return rows.map(r => (r.c[0]?.v)).filter(Boolean);
    }

    // Penguji
    fetchSheet(sheetNames.penguji).then(data => {
      const select = document.getElementById('penguji');
      select.innerHTML = '<option value="">Pilih Penguji</option>' + data.map(v => `<option>${v}</option>`).join('');
    });

    // Kelas
    fetchSheet(sheetNames.kelas).then(data => {
      const select = document.getElementById('kelas');
      select.innerHTML = '<option value="">Pilih Kelas</option>' + data.map(v => `<option>${v}</option>`).join('');
    });

    // Surat
    fetchSheet(sheetNames.surat).then(data => {
      const select = document.getElementById('surat');
      select.innerHTML = '<option value="">Pilih Surat</option>' + data.map(v => `<option>${v}</option>`).join('');
    });

    // Keterangan
    fetchSheet(sheetNames.keterangan).then(data => {
      const select = document.getElementById('keterangan');
      select.innerHTML = '<option value="">Pilih Keterangan</option>' + data.map(v => `<option>${v}</option>`).join('');
    });

    // Ganti daftar siswa ketika kelas berubah
    document.getElementById('kelas').addEventListener('change', function() {
      const kelas = this.value.trim();
      const selectSiswa = document.getElementById('siswa');

      if (!kelas) {
        selectSiswa.innerHTML = '<option value="">Pilih kelas dulu</option>';
        return;
      }

      const kelasUtama = kelas.split(' ')[0].toUpperCase(); // Ambil "X", "XI", atau "XII"
      const sheetSiswa = sheetNames.siswa[kelasUtama];

      if (!sheetSiswa) {
        selectSiswa.innerHTML = '<option value="">Tidak ada data untuk kelas ini</option>';
        return;
      }

      fetchSheet(sheetSiswa).then(data => {
        selectSiswa.innerHTML = '<option value="">Pilih Siswa</option>' + data.map(v => `<option>${v}</option>`).join('');
      });
    });
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Penilaian Tahfidz</title>
  <style>
    body { background: #f4f7fa; font-family: Arial, sans-serif; }
    .container { background: #fff; max-width: 400px; margin: 30px auto; border-radius: 16px; box-shadow: 0 4px 16px rgba(0,0,0,0.08); padding: 32px 24px; }
    h2 { text-align: center; margin-bottom: 24px; font-size: 1.5em; font-weight: bold; }
    label { display: block; margin-bottom: 6px; font-size: 1em; }
    select, textarea { width: 100%; padding: 8px 10px; margin-bottom: 16px; border: 1px solid #ccc; border-radius: 6px; font-size: 1em; box-sizing: border-box; }
    textarea { resize: vertical; min-height: 60px; max-height: 120px; }
    .btn-submit { width: 100%; padding: 10px 0; background: #22c55e; color: #fff; border: none; border-radius: 6px; font-size: 1em; font-weight: bold; cursor: pointer; transition: background 0.2s; }
    .btn-submit:hover { background: #16a34a; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Penilaian Tahfidz</h2>
    <form>
      <label for="penguji">Nama Penguji</label>
      <select id="penguji" name="penguji"><option value="">Memuat...</option></select>

      <label for="kelas">Kelas</label>
      <select id="kelas" name="kelas"><option value="">Memuat...</option></select>

      <label for="siswa">Nama Siswa</label>
      <select id="siswa" name="siswa"><option value="">Pilih kelas dulu</option></select>

      <label for="surat">Surat</label>
      <select id="surat" name="surat"><option value="">Memuat...</option></select>

      <label for="keterangan">Keterangan</label>
      <select id="keterangan" name="keterangan"><option value="">Memuat...</option></select>

      <label for="catatan">Catatan:</label>
      <textarea id="catatan" name="catatan" placeholder="Tulis catatan di sini..."></textarea>

      <button type="submit" class="btn-submit">Kirim</button>
    </form>
  </div>

  <script>
    const baseUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR2sH-s2vgdr92fkUTW3szhKHQQPZhuuUXd62S-kk95uVXJ57kVw8LCnkDBMvzaneEP3t5A4-ePE70q/gviz/tq?tqx=out:json&sheet=';

    const sheetNames = {
      penguji: 'Nama',
      kelas: 'Kelas',
      surat: 'Surat',
      keterangan: 'Keterangan',
      siswa: {
        'X': 'Siswa X',
        'XI': 'Siswa XI',
        'XII': 'Siswa XII'
      }
    };

    async function fetchSheet(sheetName) {
      const url = baseUrl + encodeURIComponent(sheetName);
      const res = await fetch(url);
      const text = await res.text();
      const json = JSON.parse(text.substring(47, text.length - 2));
      const rows = json.table.rows;
      return rows.map(r => (r.c[0]?.v)).filter(Boolean);
    }

    // Penguji
    fetchSheet(sheetNames.penguji).then(data => {
      const select = document.getElementById('penguji');
      select.innerHTML = '<option value="">Pilih Penguji</option>' + data.map(v => `<option>${v}</option>`).join('');
    });

    // Kelas
    fetchSheet(sheetNames.kelas).then(data => {
      const select = document.getElementById('kelas');
      select.innerHTML = '<option value="">Pilih Kelas</option>' + data.map(v => `<option>${v}</option>`).join('');
    });

    // Surat
    fetchSheet(sheetNames.surat).then(data => {
      const select = document.getElementById('surat');
      select.innerHTML = '<option value="">Pilih Surat</option>' + data.map(v => `<option>${v}</option>`).join('');
    });

    // Keterangan
    fetchSheet(sheetNames.keterangan).then(data => {
      const select = document.getElementById('keterangan');
      select.innerHTML = '<option value="">Pilih Keterangan</option>' + data.map(v => `<option>${v}</option>`).join('');
    });

    // Ganti daftar siswa ketika kelas berubah
    document.getElementById('kelas').addEventListener('change', function() {
      const kelas = this.value.trim();
      const selectSiswa = document.getElementById('siswa');

      if (!kelas) {
        selectSiswa.innerHTML = '<option value="">Pilih kelas dulu</option>';
        return;
      }

      const kelasUtama = kelas.split(' ')[0].toUpperCase(); // Ambil "X", "XI", atau "XII"
      const sheetSiswa = sheetNames.siswa[kelasUtama];

      if (!sheetSiswa) {
        selectSiswa.innerHTML = '<option value="">Tidak ada data untuk kelas ini</option>';
        return;
      }

      fetchSheet(sheetSiswa).then(data => {
        selectSiswa.innerHTML = '<option value="">Pilih Siswa</option>' + data.map(v => `<option>${v}</option>`).join('');
      });
    });
  </script>
</body>
</html>
